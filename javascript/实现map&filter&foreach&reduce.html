<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        const array = [14, 16, 30, 40, 51, 49];
        

        // 实现map
        Array.prototype.myMap = function(fn) {
            // 错误处理
            isArr = Object.prototype.toString.call(this) === '[object Array]';
            if (!isArr) {
                throw new TypeError(this + '.' + 'myMap is not a function');
            }
            
            let newArr = [];
            for (let index = 0; index < this.length; index++) {
                newArr.push(fn(this[index], index, this));               
            }
            return newArr;
        }
        let mapResult = array.myMap((item, index, array) => item = item * 2);
        console.log(mapResult);


        // 实现filter
        Array.prototype.myFilter = function(fn) {
            // 错误处理
            isArr = Object.prototype.toString.call(this) === '[object Array]';
            if (!isArr) {
                throw new TypeError(this + '.' + 'myFilter is not a function');
            }

            let newArr = [];
            for (let index = 0; index < this.length; index++) {
                fn(this[index], index, this) && newArr.push(this[index]);               
            }
            return newArr;
        }
        let filterResult = array.myFilter((item, index, array) => item > 23);
        console.log(filterResult);


        // 实现forEach
        Array.prototype.myForEach = function(fn) {
            // 错误处理
            isArr = Object.prototype.toString.call(this) === '[object Array]';
            if (!isArr) {
                throw new TypeError(this + '.' + 'myForEach is not a function');
            }

            for (let index = 0; index < this.length; index++) {
                fn(this[index], index, this);
            }
        }
        let foreachResult = array.myForEach(item => item > 23);
        console.log(foreachResult);


        // 实现reduce
        Array.prototype.myReduce = function(fn, initVal) {
            // 错误处理
            isArr = Object.prototype.toString.call(this) === '[object Array]';
            if (!isArr) {
                throw new TypeError(this + '.' + 'myReduce is not a function');
            }

            for (let index = 0; index < this.length; index++) {
                if (typeof initVal === 'undefined') {
                    // 给val赋个初始值
                    initVal = this[index];
                } else {
                    // total就是初始值val，之后的依次传入对应
                    initVal = fn(initVal, this[index], index, this);
                }
            }
            return initVal;
        }
        let reduceResult = array.myReduce((sum, currentVal, index, array) => sum += currentVal, 0);
        console.log(reduceResult);
    </script>
</body>
</html>