{"version":3,"sources":["src/react-dom/dom.js","src/react-dom/render.js","src/react-dom/diff.js","src/react/component.js","src/react/create-element.js","src/react/index.js","src/react-dom/index.js","index.js"],"names":["setAttribute","dom","name","value","test","toLowerCase","style","cssText","removeAttribute","_render","vnode","undefined","String","tag","component","attrs","base","textNode","document","createTextNode","createElement","Object","keys","forEach","key","children","child","render","container","innnerHTML","appendChild","renderComponent","renderer","componentWillUpdate","componentDidUpdate","componentDidMount","parentNode","replaceChild","_component","setComponentProps","props","componentWillMount","compoentWillReceiveProps","createComponent","inst","prototype","Component","constructor","state","stateChange","assign","App","React","Conuter","num","console","log","setState","onClick","ReactDOM","getElementById"],"mappings":";;AOAA;;AACA;;;ADDA,AHAA,ACAA,ACAA;AJAA,AGCA;AFDA,AFAO,AIEP,ACDA,SLDgBA,YAAT,CAAsBC,GAAtB,EAA2BC,IAA3B,EAAiCC,KAAjC,EAAwC;AAC3C,ACAJ,AGEA;AFFA,AFCI,AIEJ,MJFQD,IAAI,KAAK,AMAF,WNAX,EAA0B;AEA9B,AFCQA,AMAJyB,ALDG,AGGP,EEFIA,ENAIzB,IAAI,AMAF,CLDMO,AGGPW,CEFLO,CNAW,KCDR,CAAiBjB,CDChB,ICDD,AGGP,CAAwBG,CHHO,EGG/B,EAA6BE,KAA7B,EAAiD;AFFjD,AFCK,AMFU,ALCX,AGIAA,EAAAA,CJP2C,CAK3C,ECFIL,CGIC,GAAGK,CHJC,IGII,ACJF,CJAGJ,GGIG,EAAjB,IHJI,IAAuBD,KAAK,KAAK,IAAjC,IAAyC,OAAOA,KAAP,KAAiB,SAA9D,EAAyE;ACC7E,ADAQA,AIAJoC,EAAAA,EJAIpC,KAAK,EIAA,CJAG,CIAZoC,CJAI,iBIDO;AHEf,ADAK,AGA4C,ACA7C1B,EAAAA,EFJE0B,WEIW,EAAb1B,mBDAmCK,QAAU;AFCjD,AFAI,AGJA,ACGmCA,ACFxB,IDEwBA,EJC/B,MIDyC,EJCjCrB,IAAR,CAAaF,IAAb,CAAJ,EAAwB;AEGrB,AFFCA,ACDJ,AEHA,ACE6C,IJEzCA,ECDA,EDCI,CEEI6B,EFFD7B,ECDAQ,EDCI,CAACL,ECDZ,KAAiB,CCGlB,CAAyBS,EFFjB,EAAP,ECDJ,EAA+B,CCG5B,EAAoC;AACvC,AFFIb,ACDAS,AEHJ,IHIIT,ACDAS,ECGAM,CFFG,CAACd,CCDC,CCGT,CADuC,CAEvC,AFHO,ACDKU,CDCR,GAAYT,ECDE,CAACO,EDCE,GCDH,CDCO,ACDrB,EDCA,CAFoB,CAGpB;AACH,ACFA,AEHD,ACIA,GJHA,ACJ2B,CAQ3B,KDAO,AIDA,IJCIR,IAAI,KAAK,CGLI,MHKjB,EAAsB;AEE7B,AFDI,ACAJ,AENwB,ACKpBW,IAAAA,EFEEmB,CEFC,CJCC,AGNIQ,CHMHrC,AIDLU,GADG,CDJiB,CDOV,AFDN,GECSC,CFDC,OAAOX,CECC,CAACwB,GFDT,GECD,EAAjB,AFDmC,QAA/B,EAAyC,uCGNzB,EAAI;AHOhB1B,ACAR,AGDIc,IAAAA,EJCId,GAAG,AIDF,CJCGK,CIDRS,IJCI,CAAUR,AIHX,OJGC,GAAoBJ,KAAK,IAAI,EAA7B;AECR,AFAK,ACAL,AERwB,ACOpBsB,IAAAA,CJDA,CEEAX,KFAO,CIDC,EAARW,CFCS,AFAEtB,CEADa,IAAV,AFAgB,IEAEF,AFAE,QAAOX,CEAA,CAAC8B,GFAR,MAAiB,QAA9B,EEAX,AFAmD,EEAE;AACjDnB,AFAI,ACAR,AGLO,GAAP,CFKIA,OFAS,EEAA,CAACmB,CFAG/B,KAAT,IAAiBC,KAAjB,EAAwB,EEA5B;AACH,AFAW,AGTR,ACQP,SDRY6C,KAAL,GAAa,EAAb;AHUQ/C,AGTR,QHSQA,CGTHuC,EHSM,CAAClC,EGTZ,GHSQ,AGTKkC,CHSKtC,IGTlB,CHSQ,IAAkB,OAAOC,KAAK,CAAED,KAAF,CAAZ,KAAyB,QAAzB,GAAoCC,KAAK,CAAED,KAAF,CAAL,GAAgB,IAApD,GAA2DC,KAAK,CAAED,KAAF,CAAlF;AEAZc,AFCS,ACFT,AEPC,EDQDA,ECPA,EDOI,ADDA,GCCG,IDDIN,EGCAU,GHDK,CAACP,GAAb,KAAqB,ICCVmB,MDDf,ECCO,ADD8B,CCCrC;AFEK,ACFD,AENJ,KHA6B,CASzB;AEAJ,ADFI,MCEClB,EDFKA,OCEI,CAACE,CDFI,GCEnB,ADFsB,ECEA,yBDFgBN,KAAK,CAACG,GAAtB,EAA2BH,KAAK,CAACK,KAAjC,CAAlB;ACGA,AFAH,ACFG,GDRG,KEUED,CFAF,QEAW,CAACoB,eDFGpB,GCElB,EAAoCA,IDFpC,EAA6BJ,GCEgB,CAACwB,CDFZ,CAACnB,KAAnC,WCEoC;AACvC,AFAG,ACFA,GCAJ,CKhBEoC,IPkBMjD,CEAD,EDFIY,CDEC,CEAAA,GFAIb,GAAZ,CCFgB,CDEC,ACFAe,CCEA,CAACmB,EDFlB,eCEG,EAAmC;AACtCrB,AFAIb,ACFP,GAlB0B,CCoBvBa,ADDJ,EDCQb,GAAG,CAAEC,GEAA,CAACiC,AFAH,CAAH,GAAchC,KAAK,IAAI,EAAvB,EEAJ;AACH,AFAI,6BGZI8C,aAAa;AAClB;ADaJ,AFDI,ACFJ,AETI5B,MDYCP,ADHD,AETAO,EHWIlB,IGXE,CHWN,ACFOO,AETAwC,EDYG,AFDC,CECAlC,EDHX,CETA,CDYC,ACZa,GFSG,CCGEF,CCZAkC,KAAnB,CFSA,CET0BC,CDYE,CAACjC,CDHA,GCGV,CAAeoB,GDHE1B,CETpC,EAFkB,CAGlB,CFQ6B,ECGjC,EAAmD,CDHD,QAAlD,EAA4D;ACIxDI,AFDIb,ACFJ,ICGAa,EFDIb,ECFAgB,CDEG,CAACjB,GECC,CAACgB,EDHE,ECGZ,CAAeoB,ADHAlB,GDEX,CAAiBhB,IAAjB,ACFmB,CAACiB,CCGxB,AFD2BhB,CECDkC,IFDtB,QECJ,ADHe,CCGyBrB,ADHDN,ICGvC,CDHe,CCG+BI,ADH9C,SCGuD,CAACE,IAAxD;AACH,AFDI,ACFD,AETA,GDNmC,CAoBvC,CFLI,MAEO,ACFAC,QAAP,cETgB,IAAhB;ADeJ,AFHQhB,ACFP,AETA,MHWOA,GAAG,CAACO,eAAJ,CAAoBN,IAApB;AACH;AACJ,ACFD,MAAMD,GAAG,GAAGiB,QAAQ,CAACE,aAAT,CAAuBV,KAAK,CAACG,GAA7B,CAAZ;ACIAC,AFDH,EECGA,SAAS,CAACE,IAAV,GAAiBA,IAAjB;AACAA,ADHA,ECGAA,IAAI,ADHAN,CCGC4B,IDHI,CAACvB,KCGV,ADHA,EAAiB,CCGCD,SAAlB;AACH,ADHOO,IAAAA,MAAM,CAACC,IAAP,CAAYZ,KAAK,CAACK,KAAlB,EAAyBQ,OAAzB,CAAiC,UAAAC,GAAG,EAAI;AACpC,UAAMrB,KAAK,AEbR2C,GFaWpC,KAAK,CAACK,KM3BnB,AN2Ba,CAAYS,GAAZ,CAAd;AM1BJ,AL6BD,ADFK,SCEIe,IK7BD,aL6BR,CAA2BzB,EDFTb,GAAb,EAAkBuB,ECEvB,CDFK,CCEiCgB,CDFVrC,ICE5B,CDFK,CCEwC,CDJJ,CAEL,qBM3BnC;AACH,AL6BD,ADFK,KAHD,CCKA,CAACW,SAAS,CAACE,IAAf,EAAqB;AACjB,ADFH,QCEOF,SAAS,CAAC2B,kBAAd,EAAkC;AAC9B3B,MAAAA,SAAS,CAAC2B,kBAAV;AACH,ADHL/B,EAAAA,GCCI,EDDC,CAACe,GCGK,IAAIX,CDHf,CAAeS,OCGS,ADHxB,CCGyBmB,ADHF,UAAAhB,KAAK,SCGjB,EAAwC;AAC3CZ,ADJoB,EMhCdsC,ILoCNtC,KDJwBa,ICIf,CAACe,CKpCEI,ANgCkB,CAACpB,KAAD,EAAQzB,GAAR,CAAV,WCIpB;AACH,ADLuB,GAA5B,EAjC2B,CAiC0B;IM1BnDoD;ALiCEvC,ADLJ,ICKIA,KDLGb,GAAP,CCKa,CAACuC,KAAV,GAAkBA,KAAlB,CAPiB,CAQjB;AACA,ADNP;AACD;ACMQT,ADLR,ICKQA,eAAe,CAACjB,SAAD,CAAf;AKnCJ,ALoCC,ADLL,mBM/BiB0B,KAAb,EAAqB;AAAA,ALqCxB,ADLD;AACA;AMjCyB,ALsClB,SAASG,eAAT,CAAyB7B,SAAzB,EAAoC0B,KAApC,EAA2C;AAC9C,MAAII,IAAJ,CAD8C,CAE9C;AKvCI,ANiCR,SAASjB,MAAT,CAAiBjB,KAAjB,EAAwBkB,QMjCTY,CNiCf,EAAmC,EMjC3B;AACA,ALuCJ,ADNAZ,EAAAA,ICMId,IKvCKkC,CNiCA,CAACnB,GMjCN,ALuCS,CAACgB,EKvCG,INiCjB,GCMI,ADNmB,EAAvB,CAD+B,CCOJ/B,ADL3B,SCKoC,CAAC+B,SAAV,CAAoBlB,MAA/C,EAAuD;AKtC/C2B,ALuCJV,IAAAA,EKvCIU,ELuCA,CKvCG,EAAE,ALuCF,IAAIxC,SAAJ,CAAc0B,KAAd,CAAP,CADmD,CAEnD;AKzCa,AL0ChB,ADPD,GCIA,EKvCI,IL0CG,ADPAZ,SAAS,CAACE,WAAV,CAAsBrB,OAAO,CAACC,KAAD,CAA7B,CAAP;AMrCqB,AL6CjBkC,ADPP,ICOOA,IAAI,GAAG,IAAIE,SAAJ,CAAcN,KAAd,CAAP;AKxCH,ALyCGI,IAAAA,IAAI,CAACG,WAAL,GAAmBjC,SAAnB;eDNOa;ACOPiB,IAAAA,IAAI,CAACjB,MAAL,GAAc,YAAY;AACtB,aAAO,KAAKoB,WAAL,CAAiBP,KAAjB,CAAP;AACH,KAFD,qCKzCkB;AAClBe,AL2CH,MK3CGA,OAAO,CAACC,GAAR,CAAa,QAAb;AACH;AL2CD,SAAOZ,IAAP;AACH;yCK1CwB;AACjBW,MAAAA,OAAO,CAACC,GAAR,CAAa,OAAb;AACH;;;8BAES;AACN,WAAKC,QAAL,CAAe;AAAEH,QAAAA,GAAG,EAAE,KAAKN,KAAL,CAAWM,GAAX,GAAiB;AAAxB,OAAf;AACH;;;6BAEQ;AAAA;;AACL,aACI;AAAK,QAAA,OAAO,EAAG;AAAA,iBAAM,MAAI,CAACI,OAAL,EAAN;AAAA;AAAf,SACI,qDAAa,KAAKV,KAAL,CAAWM,GAAxB,CADJ,EAEI,mDAFJ,CADJ;AAMH;;;;EA1BiBF,eAAMN;;AA6B5Ba,kBAAShC,MAAT,CAAgB,6BAAC,OAAD,OAAhB,EAA6BT,QAAQ,CAAC0C,cAAT,CAAwB,MAAxB,CAA7B","file":"simple-react.e31bb0bc.js","sourceRoot":"..","sourcesContent":["export function setAttribute(dom, name, value) {\r\n    // 如果属性名是className，则返回class\r\n    if (name === 'className') {\r\n        name = 'class';\r\n    }\r\n    // 如果属性名是onXXX，则是一个监听方法\r\n    if (/on\\w+/.test(name)) {\r\n        name = name.toLowerCase();\r\n        dom[name] = value || '';\r\n        // 如果属性名style，则更新style对象\r\n    } else if (name === 'style') {\r\n        if (!value || typeof value === 'string') {\r\n            dom.style.cssText = value || '';\r\n        } else if (value && typeof value === 'object') {\r\n            for (let name in value) {\r\n                // 可以通过style={ width: 20 }这种形式来设置样式，可以省略掉单位px\r\n                dom.style[name] = typeof value[ name ] === 'number' ? value[ name ] + 'px' : value[ name ];\r\n            }\r\n        }\r\n        // 普通属性则直接更新属性\r\n    } else {\r\n        if (name in dom) {\r\n            dom[ name ] = value || '';\r\n        }\r\n        if (value) {\r\n            dom.setAttribute(name, value);\r\n        } else {\r\n            dom.removeAttribute(name);\r\n        }\r\n    }\r\n}","import { createComponent, setComponentProps } from './diff';\r\nimport { setAttribute } from './dom';\r\nexport function _render(vnode) {\r\n    if (vnode === undefined || vnode === null || typeof vnode === 'boolean') { \r\n        vnode = '';\r\n    }\r\n    if (typeof vnode === 'number') {\r\n        vnode = String(vnode);\r\n    }\r\n\r\n    // function Welcome( props ) {\r\n    //     return <h1>Hello, {props.name}</h1>;\r\n    // }\r\n    // tag 是 Welcome\r\n    // 区分组件和原生DOM的工作，是babel-plugin-transform-react-jsx帮我们做的\r\n    if (typeof vnode.tag === 'function') {\r\n        // createComponent方法创建组件实例，并且将函数定义组件扩展为类定义组件进行处理\r\n        const component = createComponent(vnode.tag, vnode.attrs);\r\n        setComponentProps(component, vnode.attrs);\r\n        return component.base;\r\n    }\r\n    // 当vnode为字符串时，渲染结果是一段文本\r\n    if (typeof vnode === 'string' || typeof vnode === 'number') {\r\n        let textNode = document.createTextNode(vnode)\r\n        return textNode;\r\n    }\r\n\r\n    const dom = document.createElement(vnode.tag);\r\n\r\n    if (vnode.attrs) {\r\n        Object.keys(vnode.attrs).forEach(key => {\r\n            const value = vnode.attrs[key];\r\n            setAttribute(dom, key, value); // 设置属性\r\n        });\r\n    }\r\n    vnode.children.forEach(child => render(child, dom)); // 递归渲染子节点\r\n\r\n    return dom; \r\n}\r\n/* \r\n    render的第一个参数接收的是createElement返回的对象\r\n    第二个参数是挂载的目标DOM\r\n    render的作用就是将虚拟DOM渲染成真实的DOM\r\n*/\r\nfunction render (vnode, container) {\r\n    container.innnerHTML = '';\r\n    // 将渲染结果挂载到真正的DOM上\r\n    return container.appendChild(_render(vnode));\r\n}\r\n\r\nexport default render","import { _render } from './render'\r\n/**\r\n * @param {HTMLElement} dom 真实DOM\r\n * @param {vnode} vnode 虚拟DOM\r\n * @param {HTMLElement} container 容器\r\n * @returns {HTMLElement} 更新后的DOM\r\n**/\r\n\r\n\r\nexport function renderComponent(component) {\r\n    let base;\r\n    // 调用组件的render函数返回dom对象\r\n    const renderer = component.render();\r\n    if (component.base && component.componentWillUpdate) {\r\n        component.componentWillUpdate();\r\n    }\r\n    base = _render(renderer);\r\n    \r\n\r\n    if ( component.base ) {\r\n        if ( component.componentDidUpdate ) component.componentDidUpdate();\r\n    } else if ( component.componentDidMount ) {\r\n        component.componentDidMount();\r\n    }\r\n\r\n    if ( component.base && component.base.parentNode ) {\r\n        component.base.parentNode.replaceChild( base, component.base );\r\n    }\r\n\r\n    // component.base保存组件实例最终渲染出来的DOM\r\n    // 反过来base._component保存的是dom对象所对应的组件，这个就是为了把他们关联起来\r\n    component.base = base;\r\n    base._component = component;\r\n}\r\nexport function setComponentProps(component, props) {\r\n    if (!component.base) {\r\n        if (component.componentWillMount) {\r\n            component.componentWillMount();\r\n        } else if (component.compoentWillReceiveProps) {\r\n            component.compoentWillReceiveProps();\r\n        }\r\n\r\n        component.props = props;\r\n        // renderComponent方法用来渲染组件，setState方法会直接调用这个方法进行重新渲染\r\n        // 在这个方法里可以实现componentWillUpdate, componentDidUpdate, componentDidMount\r\n        renderComponent(component);\r\n    }\r\n}\r\nexport function createComponent(component, props) {\r\n    let inst;\r\n    // 如果是类定义组件，则直接返回实例\r\n    if (component.prototype && component.prototype.render) {\r\n        inst = new component(props);\r\n        // 如果是函数定义组件，则将其扩展为类定义组件\r\n    } else {\r\n        inst = new Component(props);\r\n        inst.constructor = component;\r\n        inst.render = function () {\r\n            return this.constructor(props);\r\n        }\r\n    }\r\n    return inst;\r\n}","import { renderComponent } from '../react-dom/diff';\r\nclass Component {\r\n    // 通过继承React.Component定义的组件有自己的私有状态state可以通过this.state获取到\r\n    // 同时也能通过this.props来获取传入的数据\r\n    // 所以在构造函数中，需要初始化state和props\r\n    constructor(props = {}) {\r\n        this.state = {};\r\n        this.props = props;\r\n    }\r\n    // 组件内部的state和渲染相关，state改变时通常会出发渲染，为了让react\r\n    // 直到我们改变了state，我们只能通过setState方法修改数据\r\n    setState(stateChange) {\r\n        // 将修改合并到state\r\n        Object.assign(this.state, stateChange);\r\n        // 在每次更新state后，需要调用renderComponent方法重新渲染组件\r\n        renderComponent(this);\r\n    }\r\n}\r\nexport default Component;","/* \r\n    React.createElement\r\n    jsx片段会被转译成用React.createElement方法包裹的代码\r\n    返回一个对象来保存它的信息\r\n*/\r\nfunction createElement (tag, attrs, ...children) {\r\n\r\n    attrs = attrs || {};\r\n\r\n    return {\r\n        tag,\r\n        attrs,\r\n        children\r\n    }\r\n}\r\n\r\nexport default createElement;","import Component from './component.js';\r\nimport createElement from './create-element.js'\r\n\r\nexport default {\r\n    Component,\r\n    createElement\r\n}","import render from './render'\r\n\r\nexport default {\r\n    render\r\n}\r\n","import React from './src/react';\r\nimport ReactDOM from './src/react-dom';\r\n\r\nclass App extends React.Component {\r\n    render() { \r\n        return <h1>Hello World</h1>;\r\n    }\r\n}\r\n\r\nclass Conuter extends React.Component {\r\n    constructor( props ) {\r\n        super( props );\r\n        this.state = {\r\n            num: 0\r\n        }\r\n    }\r\n    componentWillUpdate() {\r\n        console.log( 'update' );\r\n    }\r\n\r\n    componentWillMount() {\r\n        console.log( 'mount' );\r\n    }\r\n\r\n    onClick() {\r\n        this.setState( { num: this.state.num + 1 } );\r\n    }\r\n\r\n    render() { \r\n        return (  \r\n            <div onClick={ () => this.onClick() }>\r\n                <h1>number: {this.state.num}</h1>\r\n                <button>add</button>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nReactDOM.render(<Conuter />, document.getElementById('root'));"]}