### HTTP
- 网络协议就是信息在网络中传递的一些规范。如同人与人之间相互交流是需要遵循一定的规矩一样，计算机之间的湘火炬通信需要共同遵守一定的规则，这些规则就成为网络协议。
- 没有网络协议的网络世界是混乱的，计算机之间想发什么就发什么。
- 互联网中的通信协议都对应7层中的某一层![七层协议](./664199e3217c41aabad4ae057d600c73_tplv-k3u1fbpfcp-zoom-1.png)
### 强缓存与协商缓存
- 1 浏览器进行资源请求时，会判断response headers是命中强缓存，如果命中，直接从本地读取缓存，不会向服务器发送请求。
- 2 当强缓存没有命中，会发送请求到服务端，判断协商缓存是否命中，如果命中，服务器将请求返回，不会返回资源，告诉浏览器从本地读取缓存。如果不命中，服务器直接返回资源。
- 区别：强缓存命中，不会请求服务器，直接使用缓存；协商缓存命中，会请求服务器，不会返回内容，然后读取缓存。强缓存的弊端很明显，即每次都是根据时间来判断缓存是否过期；但是当到达过期时间后，如果文件没有改动，再去获取文件就有点浪费服务器的资源。这时候就需要使用协商缓存了。
- 3 缓存的处理流程
  - 3.1 from memory cache：直接从内存中拿资源，速度快，页面关闭该资源被释放。
  - 3.2 from disk cache：从硬盘中拿资源，速度慢，不会随页面关闭而释放掉。
- 4 强缓存又分为Expires(HTTP1.0)和Cache-Control(HTTP1.1)
  - 4.1 Expires是一个GMT时间格式字符串，浏览器进行第一次请求的时候，服务器会在响应头上加上强缓存又分为Expires，下次请求，如果在这个时间之前则命中缓存。不推荐使用这个，时区的原因会导致客户端的时间可能与服务器的时间不一致。
  - 4.2 Cache-Control有多个属性(max-age：缓存时长(s)，public: 浏览器和代理服务器都可以缓存，private：只有浏览器可以缓存，no-cache: 不使用强缓存尝试协商缓存，no-store：不进行缓存，s-maxage：代理服务器缓存时长，must-revalidate：告诉浏览器、缓存服务器，本地副本过期前，可以使用本地副本；本地副本一旦过期，必须去源服务器进行有效性校验。)
  - 4.3 Pragma是HTTP1.0中为了向后兼容Cache-Control的一个字段作用和ache-Control一样
  - 4.4 以上三个响应头，优先级顺序为：Pragma>Cache-Control>Expires
- 5 协商缓存分为Last-Modified(If-Modified-Since)和ETag(If-None-Match)。 
  - 5.1 Last-Modified: 响应头中的字段表示资源最后的更新时间。请求头中的字段：If-Modified-Since带上响应头中Last-Modified的值。通过比较两次的时间判断，资源在请求期间是否有修改，没有则返回304从缓存读取。否则返回新的Last-Modified时间和服务器资源。
  - 5.2 Last-Modified存在一些缺点：感知时间是秒（如果在一秒内进行了多次修改）。被修改的一些内容是注释。ETag为响应头的字段，表示资源的唯一标识，随服务器返回。服务器比较请求头中的If-None-Match和当前资源的ETag是否一致来决定是否返回资源还是使用缓存。
  - 5.3 从精确度上来说ETag比Last-Modified更准确，相应的所占的内容页更大一些。
### OPTIONS请求
  - 1 CORS(Cross-Origin-Resource-Sharing)跨域资源共享是针对跨域的一种解决方案。分为简单请求和非简单请求。针对非简单请求，浏览器首先使用OPTIONS方法发起一个预检请求(preflight request)，从而获知服务端是否允许该跨域请求。服务器确认之后，才发起实际的HTTP请求。在预检请求的返回中，服务器端也可以通知客户端，是否需要携带身份凭证
    - 1.1 只要是满足下图的都是简单请求不需要发起预检请求。
    - Access-Control-Max-Age这个响应头表示预检请求的返回结果可以被缓存多久。